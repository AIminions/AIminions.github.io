---
layout: single
title: "딥러닝, 파이토치 1편"
date: 2025-06-05
categories: [프로젝트]
tags: [딥러닝, MS AI School]
header:
  overlay_image: /assets/images/aischool.jpg
  teaser: /assets/images/aischool.jpg
  caption: "AI school 로고"
---

<style>
/* ─── 썸네일 크기 조절 ───────────────────────────── */
.page__hero--overlay {
  height: 200px !important;           /* 원하는 높이(px)로 조절 */
  background-size: contain !important;/* 이미지 비율 유지하면서 축소 */
  background-position: center center;
}
</style>

---

# 파이토치 = 딥러닝 기본 프레임워크.

파이토치는 페이스북에서 개발 한 프레임워크로
GPU 자원을 직접 사용해서 연산을 해주는 고마운 도구입니다.
이걸 통해 역전파등 미분계산을 해서 딥러닝 모델개발을 할 수 있어요.

## 모듈설명

1. torch: 파이토치의 중심 (기초 수학 계산 + 텐서)
   무슨 역할?
   파이토치의 핵심 기능이 모여 있는 메인 공간.
   우리가 계산하려는 **숫자 덩어리(=텐서)**를 만들고 계산할 때 가장 기본이 되는 곳이야.

예시 상황:
"숫자들을 담은 그릇을 만들고 더하고 빼고 곱하고 나누고 싶다!" → torch가 해줌.

한 줄 요약:
➤ 텐서 = 숫자 뭉치 = numpy와 비슷한 파이토치 계산용 도구

2.  torch.autograd: 자동 미분을 해주는 똑똑한 계산기
    무슨 역할?
    머신러닝에서 **기울기(=미분)**를 자동으로 계산해줘.
    역전파(backpropagation) 계산의 핵심이야.

예시 상황:
"모델이 잘못 예측했을 때, 어떻게 고쳐야 할지 계산해줘!"
→ autograd가 자동으로 미분해서 알려줌.

한 줄 요약:
➤ 학습 중에 기울기 자동 계산기 역할을 함.

3.  torch.nn: 신경망 레고 블록
    무슨 역할?
    레이어(층), 모델 구조, 손실함수 같은 것들을 쉽게 만들 수 있는 도구세트.

예시 상황:
"딥러닝 모델을 만들고 싶어요. 레고처럼 쌓고 싶어요!"
→ nn.Linear, nn.ReLU, nn.Sequential 등을 사용해서 쉽게 모델 구성 가능.

한 줄 요약:
딥러닝 모델을 만들 때 쓰는 블록 모음집.

4.  torch.multiprocessing: 동시에 여러 작업을 돌릴 때
    무슨 역할?
    한 번에 여러 작업을 병렬로 처리할 수 있게 해줘. 특히 데이터 로딩, 대규모 연산에 유용.

예시 상황:
"CPU 여러 개를 써서 데이터를 빠르게 읽고 싶어요!"
→ multiprocessing을 이용해서 여러 개의 일꾼이 동시에 작업 가능.

한 줄 요약:
➤ 데이터 로딩 속도나 연산 속도를 높이기 위한 병렬 처리 도구.

5. torch.optim: 똑똑한 학습 도우미
   무슨 역할?
   모델이 학습할 때 파라미터를 조절하는 알고리즘(SGD, Adam 등)을 제공해.

예시 상황:
"모델이 더 똑똑해지도록 파라미터를 어떻게 바꿀까요?"
→ torch.optim.SGD, torch.optim.Adam 같은 도구들이 자동으로 조정해줌.

한 줄 요약:
➤ 모델 학습 중에 어떻게 개선할지 방향을 알려주는 GPS 역할.

6. torch.utils: 다양한 도구함
   무슨 역할?
   자주 쓰이는 보조 기능들을 모아놓은 공간. 예를 들면 데이터셋 나누기, 배치 처리 등.

예시 상황:
"데이터를 조금씩 나눠서 모델에 넣고 싶어요!"
→ torch.utils.data.DataLoader 사용.

한 줄 요약:
➤ 데이터 다루기 도우미 역할.

7. torch.onnx: 모델을 다른 프레임워크로 넘겨주는 번역기
   무슨 역할?
   PyTorch로 만든 모델을 **다른 프레임워크(TensorFlow, Caffe 등)**에서도 쓸 수 있게 변환해줌.

예시 상황:
"PyTorch로 학습시켰는데, 이걸 모바일 앱이나 다른 시스템에서 쓰고 싶어요!"
→ ONNX로 바꾸면 다른 곳에서도 재사용 가능.

한 줄 요약:
➤ PyTorch 모델을 다른 시스템에서도 쓸 수 있게 해주는 번역기.

---

# 통찰

## .empty

아래 사진처럼 .empty 는 **텐서** 즉, 데이터를 담을 그릇을 만들어주는데 empty는 초기화는 전혀 하지 않은채로 생성시켜줘요.
<img src="/assets/images/DNN study1.png" alt=".empty 설명1" style="width:50%;">
그러나 이 값들이 모두 0이라서 .zeros라고 생각할 수 있지만
어쩌다 우연하게 0으로 생성된 쓰레기값(Garbage value) 입니다. 임의의 값이므로 우연히 해당 메모리 공간에 0이 있었을 뿐 이에요.

방금 또 이름만 같은 새로운 변수(X2)에 넣었는데
<img src="/assets/images/DNN study2.png" alt=".empty 설명2" style="width:50%;">
값이 달라졌죠. 저 값들은 이전 데이터 값 입니다.

> PyTorch는 성능을 위해 OS로부터 받은 메모리 공간을 "그냥 쓰기 시작"한다.

라고 합니다. 직전에 사용한 임시사용 계산 이 저장되어있던 RAM 공간이죠.

그렇다면 이유는 무엇일까요.

> 초기화는 생각보다 비싼 작업이다. **.empty()**는 "속도를 위해서 초기화를 생략"하는 기능이다.

PyTorch의 공식 문서도 다음과 같이 경고합니다:

⚠️ "The values in the tensor are uninitialized. You should not use them before overwriting."
-> .empty()는 고급 사용자들이 “어차피 금방 데이터를 덮어쓸 거야”라는 전제를 가질 때만 쓰는 함수야.

따라서 empty로 텐서를 생성하는 것 보다는
단순한 테스트라도 .zeros()나 .rand()로 대체하는 것이 안전할 수 있습니다.

---

# 마무리

앞으로 내부적으로 매커니즘이 필요한 함수들을 계속해서 적어나갈 생각입니다.
그렇게 계속 하루하루 쌓아가다 보면 나름 파이토치를 사용한다고 말할 수 있겠죠..그래도 부족하지만요.
오늘도 읽어주셔서 감사합니다.
